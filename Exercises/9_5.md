# Exercise 9.5

Consider the directed graph for a Gaussian mixture model shown in Figure 9.6. By making use of the d-separation criterion discussed in Section 8.2, show that the posterior distribution of the latent variables factorizes with respect to the different data points so that
$$
p(Z|X, \mu, \Sigma, \pi) = \prod_{n = 1}^N p(z_n|x_n, \mu, \Sigma, \pi).\tag{9.80}
$$

## Solution

The samples are independent $(1)$, recall that
$$
p(X, Y|Z) = P(X|Y, Z) p(Y|Z).\tag{2}
$$
by Bayes.

Note that the plates are individually independent given the parameters, i.e.,
$$
p(x_i, z_i, x_j, z_j|\pi, \mu, \Sigma) = p(x_i, z_i|\pi, \mu, \Sigma) p(x_j, z_j|\pi, \mu, \Sigma),
$$
this means
$$
p(X, Z | \pi, \mu, \Sigma) = \prod_{n = 1}^N p(x_n, z_n | \pi, \mu, \Sigma). \tag{3}
$$
To see this note that we have two possible paths between $(x_i, z_i)$ and $(x_j, z_j)$ for $i \neq j$, first through $\pi$ then we have a divergence $z_i \leftarrow \pi \rightarrow z_j$ where $\pi$ is observed. If we go through $\mu$ (resp. $\Sigma$) then we again have a divergence $x_i \leftarrow \mu \rightarrow x_j$ where $\mu$ (resp. $\Sigma$) is observed, so it's blocking.

With that we can now compute
$$
\begin{aligned}
p(X, Z | \pi, \mu, \Sigma) &\overset{3}{=} \prod_{n = 1}^N p(x_n, z_n|\pi, \mu, \Sigma) \\
&\overset{2}{=} \prod_{n = 1}^N p(z_n|x_n, \pi, \mu, \Sigma) p(x_n|\pi, \mu, \Sigma) \tag{4}
\end{aligned}
$$

We get
$$
p(Z|X, \mu, \Sigma, \pi) \overset{2}{=} \frac{p(X, Z, \pi, \mu, \Sigma)}{p(X|\pi, \mu, \Sigma)}, \tag{5}
$$
and we know that the $x_i$ are independent samples so they are also conditionally independent w.r.t. the params and we get
$$
\begin{aligned}
p(Z|X, \mu, \Sigma, \pi) &\overset{5}{=} \frac{p(X, Z, \pi, \mu, \Sigma)}{p(X|\pi, \mu, \Sigma)} \\
&\overset{1}{=}  \frac{p(X, Z, \pi, \mu, \Sigma)}{\prod_{n = 1}^N p(x_n|\pi, \mu, \Sigma)} \\
&\overset{4}{=}  \frac{\prod_{n = 1}^N p(z_n|x_n, \pi, \mu, \Sigma)p(x_n|\pi, \mu, \Sigma)}{\prod_{n = 1}^N p(x_n|\pi, \mu, \Sigma)} \\
&= \prod_{n = 1}^N p(z_n|x_n, \mu, \Sigma, \pi),
\end{aligned}
$$
which is what was to be shown.