# Exercise 9.1
Consider the K-means algorithm discussed in Section 9.1. Show that as a consequence of there being a ﬁnite number of possible assignments for the set of discrete indicator variables $r_{nk}$, and that for each such assignment there is a unique optimum for the $\{\mu_k\}$, the $K$-means algorithm must converge after a ﬁnite number of iterations.

## Solution

We will show that $J$ either decreases or stays the same. Because there are exactly $k^n$ possible different assignments we have at most $k^n - 1$ steps that potentially decrease $J$, after that the value has to stay the same.

Sidenote: We can "flip-flop" between two equivalent assignments, for example $x_1 = -1, x_1 = 1$ with $K = 2$, both $r_{11} = 1, r_{12} = 0, r_{21} = 0, r_{22} = 1$ and $r_{11} = 0, r_{12} = 1, r_{21} = 1, r_{22} = 0$ are valid assignments and the $K$-means algo can switch between them (there is ambiguity in the choice of the argmax). As such there is no guarantee of convergence in samples only convergence in distortion measure.

Sidenote: In the solution of the book they say there is no re-assignment because the minimum is unique but I don't see how that is true given the above example, but that's mostly just splitting hairs.

There are two phases to the update step in K-means, the re-assignment to clusters
$$
r^\text{new}_{nk} =
\begin{cases}
1 & \text{if }k = \arg\max_j ||x_n - \mu_j||^2,\\
0 & \text{otherwise}
\end{cases}
$$
and re-computing the cluster means
$$
\mu_k^\text{new} = \frac{\sum_n r_{nk}x_n}{\sum_n r_{nk}}.
$$

### Re-assignment Phase

We know that $r_{nk}$ is $1$ for example one $k$, we denote this by $r_{n\star}$. In the first phase we have
$$
\begin{aligned}
J_0 &= \sum_{n = 1}^N \sum_{k = 1}^K r_{nk} ||x_n - \mu_j||^2 \\
&= \sum_{n = 1}^N ||x_n - \mu_{r_{n\star}}||^2 \\
&\geq \sum_{n = 1}^N \min_j ||x_n - \mu_{r_j}||^2 \\
&= \sum_{n = 1}^N \sum_{k = 1}^K r^\text{new}_nk ||x_n - \mu_{r_j}|| = J_1.
\end{aligned}
$$
As such the first phase does not increase the distortion measure.

### Re-computing Cluster Means Phase

In this step we apply the minimization of the quadratic function $J(\mu_1, \dots, \mu_K)$ and therefore can't increase it.

