# Exercise 9.3

Consider a Gaussian mixture model in which teh marginal distribution $p(Z)$ for the latent variable is given by
$$
p(Z) = \prod_{k = 1}^K \pi_k^{z_k},
$$
and the conditional distribution $p(X|Z)$ for the observed variable is given by
$$
p(X|Z) = \prod_{k = 1}^K \mathcal{N}(x | \underline{\mu}_k, \underline{\underline{\Sigma}}_k)^{z_k}.
$$

Show that the marginal distribution $p(X)$, obtained by summing $p(Z)p(X|Z)$ over all possible values of $Z$, is a Gaussian mixture of the form
$$
p(X) = \sum_{k = 1}^K \pi_k \mathcal{N}(X|\underline{\mu_k}, \underline{\underline{\Sigma}}_k).
$$

## Solution

$$
\begin{aligned}
p(X) &= \sum_Z p(X|Z)p(Z) \\
&= \sum_{Z = z} \left(\prod_{k = 1}^K \mathcal{N}(x | \underline{\mu}_k, \underline{\underline{\Sigma}}_k)^{z_k} \right) \left(\prod_{\ell = 1}^K \pi_\ell^{z_\ell}\right) \\
&= \sum_{Z = z, z_s = 1} \left(\prod_{k = 1}^K \mathcal{N}(x | \underline{\mu}_k, \underline{\underline{\Sigma}}_k)^{\delta_{k, s}} \right) \left(\prod_{\ell = 1}^K \pi_\ell^{\delta_{\ell, s}}\right) \\
&= \sum_{Z = z, z_s = 1} \pi_{s} \mathcal{N}(x|\underline{\mu}_{s}, \underline{\underline{\Sigma}}_s) \\
&= \sum_{s = 1}^K \pi_s \mathcal{N}(x|\underline{\mu}_s, \underline{\underline{\Sigma}}_s).
\end{aligned}
$$
where we have used the one-hot property of $Z$, namely that for each $Z = z$ there exists exactly one $k = k(z)$ such that $z_k = 1$ and for all $t$ we have $z_t = 0$, this is equivalent to
$$
z_t = \delta_{tk}.
$$